# ä¸Šæ¸¸ä»“åº“æ›´æ–°æ—¥å¿—

æœ¬æ–‡ä»¶è®°å½•ä»ä¸Šæ¸¸ (QuantumNous/new-api) åŒæ­¥çš„æ›´æ–°å†…å®¹ã€‚

---

## 2025-11-16 åŒæ­¥ (v0.9.15-patch.2 â†’ v0.9.21+)

**æ›´æ–°èŒƒå›´**: `70f8a59a..e07347ac` (52 ä¸ªæäº¤)
**æ—¶é—´è·¨åº¦**: 2025-11-01 è‡³ 2025-11-15
**æ–°å¢ç‰ˆæœ¬**: v0.9.15-patch.2, v0.9.16, v0.9.16-patch.1, v0.9.17, v0.9.18, v0.9.19, v0.9.20, v0.9.20-patch.1, v0.9.20-patch.2, v0.9.21

---

### ğŸ‰ é‡å¤§æ–°åŠŸèƒ½

#### 1. **OpenAI GPT-5.1 æ”¯æŒ** â­
- æ”¯æŒ GPT-5.1 çš„ `prompt_cache_retention` åŠŸèƒ½
- æäº¤: `e07347ac`
- ç‰ˆæœ¬: æœ€æ–°ä¸»åˆ†æ”¯

#### 2. **Replicate æ¸ é“æ”¯æŒ** ğŸ†•
- æ–°å¢å®Œæ•´çš„ Replicate æ¸ é“é€‚é…å™¨
- æ”¯æŒ Flux æ¨¡å‹
- æ–‡ä»¶: `relay/channel/replicate/`
- æäº¤: `d0c45a01`, `af0f542d`
- ç‰ˆæœ¬: v0.9.19

#### 3. **MiniMax Hailuo è§†é¢‘ç”Ÿæˆ** ğŸ¬
- æ”¯æŒ Hailuo è§†é¢‘æ¨¡å‹ (i2v, fl2v, r2v)
- æ”¯æŒè·å–è§†é¢‘ç”Ÿæˆ URL
- æ–‡ä»¶: `relay/channel/task/hailuo/`
- æäº¤: `850a5539`, `87bc4ba4`, `d8dc8029`
- ç‰ˆæœ¬: v0.9.21

#### 4. **é˜¿é‡Œ wan2.5-i2i-preview å›¾ç‰‡æ¨¡å‹** ğŸ–¼ï¸
- æ–°å¢ wan2.5-i2i-preview æ”¯æŒ
- æ–‡ä»¶: `relay/channel/ali/image_wan.go`
- æäº¤: `344a799f`
- ç‰ˆæœ¬: v0.9.21

#### 5. **Reasoning å­—æ®µæ”¯æŒ** ğŸ§ 
- æ”¯æŒ OpenAI API çš„ reasoning å­—æ®µ
- æäº¤: `fb3b27a6`, `fd38abd5`
- ç‰ˆæœ¬: v0.9.21

---

### ğŸ› é‡è¦ Bug ä¿®å¤

#### è®¡è´¹ç›¸å…³
- **ä¿®å¤ OpenAI éŸ³é¢‘æ¨¡å‹æµæ¨¡å¼è®¡è´¹é”™è¯¯** (#2160)
  - æäº¤: `6a761c2d`
  - ç‰ˆæœ¬: v0.9.16
  - å½±å“: éŸ³é¢‘æµæ¨¡å¼ä¹‹å‰è®¡è´¹ä¸æ­£ç¡®

- **ä¿®å¤æœªè®¾ç½®ä»·æ ¼æ¨¡å‹ä¸ä¼šè¢«æ‹‰å–çš„é—®é¢˜**
  - é™¤éè®¾ç½®è‡ªç”¨æ¨¡å¼
  - æäº¤: `06cd774c`

#### æ¸ é“ç®¡ç†
- **ä¿®å¤å¯†é’¥ç®¡ç†é€»è¾‘** (#2208, #2209)
  - `GetChannelKey` æƒé™ä» AdminAuth æ”¹ä¸º RootAuth
  - æäº¤: `e2d88096`, `cb047567`
  - ç‰ˆæœ¬: v0.9.20, v0.9.20-patch.1

- **ä¿®å¤å¤šå¯†é’¥è‡ªåŠ¨ç¦ç”¨é—®é¢˜** (#2188)
  - å½“æ²¡æœ‰å¯ç”¨å¯†é’¥æ—¶è¿”å›é”™è¯¯è€Œä¸æ˜¯è¿”å›ç¬¬ä¸€ä¸ªå¯†é’¥
  - æäº¤: `e87b4600`, `43ee7a98`
  - ç‰ˆæœ¬: v0.9.18

- **ä¿®å¤ Claude é‡å¤ header é—®é¢˜**
  - é˜²æ­¢ WriteHeaders æ–¹æ³•äº§ç”Ÿé‡å¤ header å€¼
  - æäº¤: `4419be9c`

#### AWS Claude
- **ä¿®å¤ AnthropicBeta å­—æ®µçš„ omitempty å¤„ç†**
  - æäº¤: `9e80e4e7`
  - ç‰ˆæœ¬: v0.9.21

- **æ·»åŠ  anthropic-beta header æ”¯æŒ**
  - æäº¤: `e1a52f1d`

#### å…¶ä»–ä¿®å¤
- **ä¿®å¤æ ‡ç­¾åˆ†å‰²å’Œç©ºæ ¼å¤„ç†**
  - æäº¤: `f6b32a66`, `65355d88`, `8ffa961d`

- **ä¿®å¤ Jimeng å›¾ç‰‡æ¨¡å‹ç›¸å…³é—®é¢˜**
  - å»æ‰åˆ†è¾¨ç‡åç¼€çš„ 'p' (å¦‚ 1080p â†’ 1080)
  - jimeng_v30_pro é™åˆ¶ä¸º jimeng_ti2v_v30_pro æ¨¡å‹
  - æäº¤: `14295f00`, `8599b348`, `29e70acc`, `2fd33ea2`

- **ä¿®å¤ Logger é—®é¢˜**
  - æäº¤: `a9a8676f`
  - ç‰ˆæœ¬: v0.9.16-patch.1

- **ä¿®å¤ Playground åŠŸèƒ½**
  - æäº¤: `fb610e62`

---

### âœ¨ åŠŸèƒ½å¢å¼º

#### Claude ç›¸å…³
- **Claude 1å°æ—¶ç¼“å­˜æ”¯æŒ** (#2155)
  - æäº¤: `df2ee649`
  - ç‰ˆæœ¬: v0.9.16

- **Thinking åç¼€ä¿ç•™é€»è¾‘**
  - `ShouldPreserveThinkingSuffix` åŠŸèƒ½
  - æäº¤: `e0822685`
  - ç‰ˆæœ¬: v0.9.18
  - æ³¨æ„: åç»­è¢«æ³¨é‡Šæ‰ (`de93fa5f`)

#### è§†é¢‘æ¨¡å‹
- **Vidu reference2video åŠŸèƒ½å¢å¼º**
  - æ”¯æŒé€šè¿‡ metadata action æŒ‡å®š reference2video
  - viduq2 ä¸“ç”¨ reference2video
  - æäº¤: `a62d96c1`, `1a8d89c4`, `bdd5eca5`

- **é˜¿é‡Œè§†é¢‘è¯·æ±‚å¤„ç†å¢å¼º**
  - åˆ†è¾¨ç‡æ˜ å°„
  - å°ºå¯¸éªŒè¯
  - æäº¤: `42432516`

#### å‰ç«¯ UI
- **EditTagModal å¢å¼º** (#2159)
  - header å’Œ param æ”¯æŒ
  - æäº¤: `019412c2`
  - ç‰ˆæœ¬: v0.9.17

- **EditTokenModal æ”¹è¿›**
  - ç”¨æˆ·åˆ›å»ºçš„ token é»˜è®¤æ— é™é¢åº¦
  - æäº¤: `c86bc94d`

- **è‡ªå®šä¹‰å·¥å…·æ”¯æŒ** (#2157)
  - æäº¤: `96a2b81a`

#### ç¯å¢ƒå˜é‡é…ç½®
- **TASK_PRICE_PATCH ç¯å¢ƒå˜é‡**
  - ç”¨äºæŒ‰ä»»åŠ¡è®¡è´¹é…ç½®
  - æäº¤: `736f7b55`

- **å…³é”®é™æµå¼€å…³**
  - æ·»åŠ ç¯å¢ƒå˜é‡æ§åˆ¶å…³é”®é™æµ
  - æäº¤: `50e8639a`

#### è¿ç»´åŠŸèƒ½
- **é™åˆ¶è‡ªåŠ¨æ¸ é“æµ‹è¯•ä»…åœ¨ä¸»èŠ‚ç‚¹æ‰§è¡Œ**
  - æäº¤: `3dc4d6c3`

---

### ğŸ”§ ä»£ç é‡æ„

- **æ³¨é‡Šæ‰ Qwen ç¼–è¾‘çš„å›¾ç‰‡æ–‡ä»¶éªŒè¯**
  - é˜¿é‡Œå›¾ç‰‡å¤„ç†
  - æäº¤: `00782aae`
  - ç‰ˆæœ¬: v0.9.15-patch.2

- **æ³¨é‡Šæ‰ enable_thinking é€»è¾‘**
  - ä¸ºæœªæ¥è°ƒæ•´åšå‡†å¤‡
  - æäº¤: `de93fa5f`
  - ç‰ˆæœ¬: v0.9.20-patch.2

- **æ·»åŠ  '-none' åç¼€åˆ° effortSuffixes**
  - æ¨¡å‹è§£æä¼˜åŒ–
  - æäº¤: `41b2341b`

---

### ğŸ“ æ–‡æ¡£æ›´æ–°

- **README.md é‡å¤§æ›´æ–°** (#2146)
  - æ”¹è¿›ç»“æ„å’Œæ¸…æ™°åº¦
  - æ–°å¢åˆä½œä¼™ä¼´ã€è‡´è°¢ã€éƒ¨ç½²è¯´æ˜ç« èŠ‚
  - æäº¤: `46b9a88f`

- **å¤šè¯­è¨€ README åŒæ­¥**
  - æäº¤: `d56e162c`

---

### ğŸ“Š ç‰ˆæœ¬æ ‡ç­¾è¯¦æƒ…

| ç‰ˆæœ¬ | æäº¤ | ä¸»è¦å˜æ›´ | æ—¥æœŸ |
|------|------|----------|------|
| v0.9.21 | 35192e56 | AnthropicBeta å­—æ®µä¿®å¤ã€Hailuo è§†é¢‘ã€wan2.5 | 2025-11-14 |
| v0.9.20-patch.2 | de93fa5f | æ³¨é‡Š enable_thinking é€»è¾‘ | 2025-11-12 |
| v0.9.20-patch.1 | 1c5de382 | GetChannelKey æƒé™ä¿®å¤ | 2025-11-11 |
| v0.9.20 | f90f5ceb | GetChannelKey æƒé™ä¿®å¤ | 2025-11-11 |
| v0.9.19 | af0f542d | Replicate æ¸ é“æ”¯æŒ | 2025-11-10 |
| v0.9.18 | e0822685 | Thinking åç¼€ä¿ç•™ã€å¤šå¯†é’¥ä¿®å¤ | 2025-11-07 |
| v0.9.17 | 019412c2 | EditTagModal å¢å¼º | 2025-11-06 |
| v0.9.16-patch.1 | a9a8676f | Logger ä¿®å¤ | 2025-11-04 |
| v0.9.16 | 6a761c2d | éŸ³é¢‘æµæ¨¡å¼è®¡è´¹ä¿®å¤ | 2025-11-04 |
| v0.9.15-patch.2 | 00782aae | Qwen å›¾ç‰‡éªŒè¯æ³¨é‡Š | 2025-11-01 |

---

### ğŸ¯ å¯¹ä½ çš„å½±å“

#### âœ… ç›´æ¥å—ç›Š
1. **GPT-5.1 æ”¯æŒ** - å¦‚æœä½¿ç”¨ OpenAI
2. **æ–°æ¸ é“**: Replicate, Hailuo - æ›´å¤šæ¨¡å‹é€‰æ‹©
3. **è®¡è´¹ä¿®å¤** - éŸ³é¢‘æµæ¨¡å¼è®¡è´¹ç°åœ¨å‡†ç¡®äº†
4. **Claude ç¼“å­˜** - 1å°æ—¶ç¼“å­˜æ”¯æŒ

#### âš ï¸ éœ€è¦æ³¨æ„
1. **æƒé™å˜æ›´** - `GetChannelKey` ç°åœ¨éœ€è¦ RootAuth
2. **å¯†é’¥ç®¡ç†** - æ— å¯ç”¨å¯†é’¥æ—¶ä¼šè¿”å›é”™è¯¯ï¼ˆä¹‹å‰è¿”å›ç¬¬ä¸€ä¸ªï¼‰
3. **ç¯å¢ƒå˜é‡** - æ–°å¢äº†ä¸€äº›é…ç½®é¡¹å¯èƒ½éœ€è¦è®¾ç½®

#### ğŸ”„ å…¼å®¹æ€§
- **æ— ç ´åæ€§å˜æ›´** - æ‰€æœ‰æ›´æ–°éƒ½å‘åå…¼å®¹
- **æ–°åŠŸèƒ½å¯é€‰** - ä¸å½±å“ç°æœ‰åŠŸèƒ½

---

### ğŸ“ ä¸»è¦æ–‡ä»¶å˜æ›´

#### æ–°å¢æ–‡ä»¶
```
relay/channel/replicate/adaptor.go
relay/channel/replicate/constants.go
relay/channel/replicate/dto.go
relay/channel/task/hailuo/adaptor.go
relay/channel/task/hailuo/constants.go
relay/channel/task/hailuo/models.go
relay/channel/ali/image_wan.go
web/src/helpers/base64.js
```

#### é‡è¦ä¿®æ”¹
```
dto/claude.go                      - Claude ç¼“å­˜å’Œ header æ”¯æŒ
dto/openai_request.go              - Reasoning å­—æ®µæ”¯æŒ
relay/channel/aws/dto.go           - AWS Claude å¢å¼º
controller/channel.go              - æ¸ é“ç®¡ç†é€»è¾‘ä¼˜åŒ–
relay/helper/price.go              - è®¡è´¹é€»è¾‘ä¿®å¤
```

#### ä¿®æ”¹ç»Ÿè®¡
- **76 ä¸ªæ–‡ä»¶ä¿®æ”¹**
- **+3889 è¡Œ**
- **-868 è¡Œ**

---

### ğŸš€ å»ºè®®è¡ŒåŠ¨

1. **æµ‹è¯•æ–°æ¸ é“**
   - å¦‚æœéœ€è¦ï¼Œå¯ä»¥å°è¯• Replicate å’Œ Hailuo è§†é¢‘åŠŸèƒ½

2. **æ£€æŸ¥æƒé™é…ç½®**
   - ç¡®è®¤ `GetChannelKey` ç›¸å…³çš„æƒé™è®¾ç½®

3. **éªŒè¯è®¡è´¹**
   - å¦‚æœä½¿ç”¨éŸ³é¢‘æµæ¨¡å¼ï¼Œæ£€æŸ¥è®¡è´¹æ˜¯å¦æ­£ç¡®

4. **é˜…è¯»æ–‡æ¡£**
   - æŸ¥çœ‹æ›´æ–°åçš„ README.md äº†è§£æ–°åŠŸèƒ½

5. **ç¯å¢ƒå˜é‡**
   - è€ƒè™‘æ˜¯å¦éœ€è¦è®¾ç½®æ–°çš„ç¯å¢ƒå˜é‡:
     - `TASK_PRICE_PATCH`
     - å…³é”®é™æµç›¸å…³é…ç½®

---

### ğŸ”— ç›¸å…³é“¾æ¥

- ä¸Šæ¸¸ä»“åº“: https://github.com/QuantumNous/new-api
- Pull Requests: https://github.com/QuantumNous/new-api/pulls?q=is%3Apr+merged%3A2025-11-01..2025-11-15

---

### ğŸ“Œ ä¸‹æ¬¡åŒæ­¥æé†’

- å®šæœŸæ£€æŸ¥ä¸Šæ¸¸æ›´æ–°: `git fetch --all`
- æŸ¥çœ‹æ–°æäº¤: `git log main..upstream/main --oneline`
- æŒ‰ç…§ `REBASE_WORKFLOW.md` æµç¨‹æ“ä½œ

---

**æœ€åæ›´æ–°**: 2025-11-16
**åŒæ­¥æ‰§è¡Œè€…**: Claude Code
**åŸºç¡€æäº¤**: 70f8a59a â†’ e07347ac
